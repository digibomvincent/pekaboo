<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>購物車</title>
    <link rel="stylesheet" href="./style/style_c1.css">
    <script src="./js/script.js"></script>
    <style>
        .nav {
            width: 100%;
            height: 60px;
            /* iframe有預設高*/
            position: fixed;
            z-index: 3;
        }

        .iframe_blank {
            height: 60px;
        }
    </style>
</head>

<body>

    <iframe class="nav" src="nav.html" frameborder="0" scrolling="no"></iframe>
    <div class="iframe_blank"></div>

    <!-- 購物車進度條 -->
    <div id="checkout">
        <div class="container">
            <div class="checkout_div">
                <div class="circle1">
                    <span class="text">1</span>
                    <p>購物車</p>
                </div>

                <div class="circle2">
                    <span class="text">2</span>
                    <p>填寫資料</p>
                </div>

                <div class="circle3">
                    <span class="text">3</span>
                    <p>訂單確認</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 購物車件數 -->
    <!-- <div id="einkaufswagen"> -->
    <hr style="color: #ccc;">
    <div class="container">

        <div class="cart">
            <table class="cart_table">
                <tr>
                    <th colspan="6">購物車</th>
                </tr>
                <tr>
                    <td colspan="2">商品資料</td>
                    <td class="text-center">單件<span class="inline-block">價格</span></td>
                    <td class="text-center">數量</td>
                    <td class="text-center">小計</td>
                    <td></td>
                </tr>
                <tr>
                    <td data-cell="商品資料" colspan="2">
                        <div class="cart_div">
                            <div class="cart_div_img">
                                <img id="paid_cloth1" src="./images/cloth/cl1-1.webp" alt="product">
                            </div>
                            <div class="cart_div_text">
                                <p class="paid_name1">日系可愛配色胸口刺繡舒適透氣上衣</p>
                                <p>BLACK</p>
                                <p>S</p>
                            </div>
                        </div>
                    </td>
                    <td id="unitPrice1" class="text-center" data-cell="單件價格">NT.990</td>

                    <td class="text-center" data-cell="數量">
                        <div class="count">
                            <button onclick="decrement(qty1)">-</button>
                            <input type="text" id="quantity1" value="1">
                            <button onclick="increment(qty1)">+</button>
                        </div>
                    </td>

                    <td id="subtotal1" class="text-center" data-cell="小計">NT.198</td>
                    <td class="x" data-cell="小計"><img class="del" src="./images/icon/x.svg" alt="delete"></td>
                </tr>
                <tr>
                    <td data-cell="商品資料" colspan="2">
                        <div class="cart_div">
                            <div class="cart_div_img">
                                <img id="paid_cloth2" src="./images/cloth/cl1.webp" alt="product">
                            </div>
                            <div class="cart_div_text">
                                <p class="paid_name2">日系可愛配色胸口刺繡舒適透氣上衣</p>
                                <p>BLUE</p>
                                <p>S</p>
                            </div>
                        </div>
                    </td>
                    <td id="unitPrice2" class="text-center">NT.990</td>
                    <td class="text-center" data-cell="數量">
                        <div class="count">
                            <button onclick="decrement(qty2)">-</button>
                            <input type="text" id="quantity2" value="1">
                            <button onclick="increment(qty2)">+</button>
                        </div>
                    </td>
                    <td id="subtotal2" class="text-center" data-cell="小計">NT.99</td>
                    <td class="x"><img class="del" src="./images/icon/x.svg" alt="delete"></td>
                </tr>
            </table>
        </div>
        <div class="cart_method" style="display: flex;">

            <div class="cart_method_pay">
                <table>
                    <!-- 選擇送貨及付款方式  -->
                    <tr>
                        <th>選擇付款方式</th>
                    </tr>

                    <tr class="line">
                        <td style="height: 87.7px;">
                            <label for="pay">付款方式</label>
                            <br>
                            <select name="payment" id="payment" onchange="showDiv(this)">
                                <option value="">請選擇付款方式</option>
                                <option value="home-delivery">貨到付款</option>
                                <option value="cv-store">信用卡</option>
                            </select>
                            <div id="hidden_div" style="display:none;">
                                <p>付款資料</p>
                                <div class="contentRow">
                                    <form actiom="" method="post" name="member-form" id="member-form" title="信用卡付款">
                                        <div class="fill">
                                            <label for="way-to-pay">已選擇的付款方式：信用卡付款</label>
                                        </div>
                                        <div class="fill">
                                            <input type="text" name="way-to-pay" id="way-to-pay1" title="請輸入姓名"
                                                placeholder="卡號" style="width: 100%; height: 40px;" required>
                                        </div>
                                        <div class="fill">
                                            <input type="text" name="way-to-pay" id="way-to-pay2" title="請輸入姓名"
                                                placeholder="持卡人姓名" style="width: 100%; height: 40px;" required>
                                        </div>
                                        <div class="fill">
                                            <input type="text" name="way-to-pay" id="way-to-pay3" title="請輸入姓名"
                                                style="width: 100%; height: 40px;" placeholder="有效期 (MM/YY)" required>
                                        </div>
                                        <div class="fill">
                                            <input type="text" name="way-to-pay" id="way-to-pay4" title="請輸入姓名"
                                                placeholder="安全碼" style="width: 100%; height: 40px;" required>
                                        </div>
                                </div>
                                <div>
                                    <div class="fill" style="padding-left: 30px;">
                                        <input type="checkbox" name="agree-checkbox" id="agree-checkbox"
                                            value="同意記住信用卡資訊及《信用卡交易協議》，以便下次快速付款。">
                                        <label for="agree-checkbox">同意記住信用卡資訊及<span
                                                style="color: blue;">《信用卡交易協議》</span>，以便下次快速付款。</label>
                                    </div>
                                </div>
                                </form>
                            </div>
                            <script type="text/javascript">
                                function showDiv(select) {
                                    if (select.value == "cv-store") {
                                        document.getElementById("hidden_div").style.display = "block";
                                    } else {
                                        document.getElementById("hidden_div").style.display = "none";
                                    }
                                } 
                            </script>
                        </td>
                    </tr>
                </table>
            </div>

            <div class="cart_method_information">
                <table>
                    <!-- 訂單資訊 -->
                    <tr>
                        <th colspan="2">訂單資訊</th>
                    </tr>
                    <tr class="line">
                        <td>小計:</td>
                        <td id="total_all" class="text-end">NT.2970</td>
                    </tr>
                    <tr>
                        <td>運費:</td>
                        <td class="text-end">NT.60</td>
                    </tr>
                    <tr class="line">
                        <td>合計:</td>

                        <td id="total_all60" class="text-end">NT.3030</td>
                    </tr>
                    <tr class="line text-center">
                        <td colspan="2"><button type="button"><a href="customer.html">前往結帳</a></button></td>
                    </tr>
                </table>
            </div>

        </div>
    </div>
    <footer>
        <iframe class="footer" src="footer.html" frameborder="0" scrolling="no"></iframe>
    </footer>
    <script>
        const name1 = document.querySelector('.paid_name1');
        const qty1 = document.getElementById('quantity1');
        const price1 = document.getElementById('unitPrice1');
        const img1 = document.getElementById('paid_cloth1');
        const subtotal1 = document.getElementById('subtotal1');
        const name2 = document.querySelector('.paid_name2');
        const qty2 = document.getElementById('quantity2');
        const price2 = document.getElementById('unitPrice2');
        const img2 = document.getElementById('paid_cloth2');
        const subtotal2 = document.getElementById('subtotal2');
        const total_all = document.getElementById('total_all');
        const total_all60 = document.getElementById('total_all60');
        var cart = JSON.parse(window.localStorage.getItem('cart')) || [];
        function updateCart() {
            /* var totalQty = 0; */
            console.log(cart.length);
            if (cart.length === 0) {
                /* cart_num.style.display = "none";
                total.textContent = "目前沒有商品" */
            } else {
                /*  cart.forEach(function (item) {
                     totalQty += item.qty;
                 });
                 cart_num.textContent = totalQty;
                 cart_num.style.display = "block";
                 total.textContent = `共有商品(${totalQty})`; */
                /* box[0].style.display = "flex"; */
                const cart1 = cart[0];
                name1.textContent = cart1.name;
                qty1.value = cart1.qty;
                price1.textContent = `NT.${cart1.price}`;
                img1.src = `./images/cloth/cl${cart1.id}.webp`;
                const total1 = qty1.value * cart1.price;
                subtotal1.textContent = `NT.${total1}`;

                if (cart.length > 1) {
                    /* box[1].style.display = "flex"; */
                    const cart2 = cart[1];
                    name2.textContent = cart2.name;
                    qty2.value = cart2.qty;
                    price2.textContent = `NT.${cart2.price}`;
                    img2.src = `./images/cloth/cl${cart2.id}.webp`;
                    const total2 = qty2.value * cart2.price
                    subtotal2.textContent = `NT.${total2}`;
                    total_all.textContent = `NT.${total1 + total2}`;
                    total_all60.textContent = `NT.${total1 + total2 + 60}`;
                }
                if (cart.length > 2) {
                    /* cart_more.style.display = "block"; */
                }
            }
        }
        document.addEventListener("DOMContentLoaded", function () {
            updateCart();
        })
        function decrement(input) {
            const cart1 = cart[0];
            const cart2 = cart[1];
            var currentValue = parseInt(input.value);
            if (currentValue > 1) {
                input.value = currentValue - 1;
            }
            const total1 = qty1.value * cart1.price;
            subtotal1.textContent = `NT.${total1}`;
            const total2 = qty2.value * cart2.price
            subtotal2.textContent = `NT.${total2}`;
            total_all.textContent = `NT.${total1 + total2}`;
            total_all60.textContent = `NT.${total1 + total2 + 60}`;
        }

        function increment(input) {
            const cart1 = cart[0];
            const cart2 = cart[1];
            var currentValue = parseInt(input.value);
            input.value = currentValue + 1;
            const total1 = qty1.value * cart1.price;
            subtotal1.textContent = `NT.${total1}`;
            const total2 = qty2.value * cart2.price
            subtotal2.textContent = `NT.${total2}`;
            total_all.textContent = `NT.${total1 + total2}`;
            total_all60.textContent = `NT.${total1 + total2 + 60}`;
        }
        //刪除
        let _del = document.querySelectorAll('.del');
        [..._del].forEach(_del => {
            _del.onclick = function () {
                _del.parentNode.parentNode.remove()
                sumTotal()
            }
        });
    </script>




</body>

</html>