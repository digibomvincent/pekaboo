<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./style/style.css">
    <script src="./js/jquery-3.7.1.min.js"></script>

</head>

<body id="nav_html">
    <header class="topbar">
        <h1 class="text_small">
            <ul class="menu2">
                <li class="hamburger">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </li>
                <li class="m_out"><a href="index.html" target="_top">HOME</a></li>
                <li><a href="sale.html" target="_top">SALE</a></li>
                <li><a href="men.html" target="_top">MEN</a></li>
                <li><a class="a4" href="women.html" target="_top">WOMEN</a></li>
                <li><a href="styling.html" target="_top">STYLING</a></li>
            </ul>
            <a id="small_expand" class="small_expand" href="index.html" target="_top">
                <img src="./images/text_small.png" alt="pekaboo logo">
            </a>
            <ul class="menu">
                <li class="m_out"><a href="index.html" target="_top">HOME</a></li>
                <li><a href="sale.html" target="_top">SALE</a></li>
                <li><a href="men.html" target="_top">MEN</a>
                    <ul class="subs">
                        <li>
                            <a href="men.html?category=上著" target="_top"></a>
                            <h1>上著</h1>
                            <ul class="subs2">
                                <div>
                                    <p>長袖</p>
                                    <p>短袖</p>
                                </div>
                                <div>
                                    <p>襯衫</p>
                                    <p>外套</p>
                                </div>
                            </ul>
                        </li>
                        <li>
                            <a href="men.html?category=下著" target="_top"></a>
                            <h1>下著</h1>
                            <ul class="subs2">
                                <div>
                                    <p>長褲</p>
                                    <p>短褲</p>
                                </div>
                                <div>
                                    <p>內褲</p>
                                </div>
                            </ul>
                        </li>
                        <li>
                            <h1>配件</h1>
                        </li>
                    </ul>
                </li>
                <li><a class="a4" href="women.html" target="_top">WOMEN</a>
                    <ul class="subs">
                        <li>
                            <a href="women.html?category=上著" target="_top"></a>
                            <h1>上著</h1>
                            <ul class="subs2">
                                <div>
                                    <a href="women.html?category=上著&subcategory=長袖" target="_top"><p>長袖</p></a>
                                    <a href="women.html?category=上著&subcategory=短袖" target="_top"><p>短袖</p></a>
                                </div>
                                <div>
                                    <a href="women.html?category=上著&subcategory=襯衫" target="_top"><p>襯衫</p></a>
                                    <a href="women.html?category=上著&subcategory=外套" target="_top"><p>外套</p></a>
                                </div>
                            </ul>
                        </li>
                        <li>
                            <a href="women.html?category=下著" target="_top"></a>
                            <h1>下著</h1>
                            <ul class="subs2">
                                <div>
                                    <a href="women.html?category=下著&subcategory=長裙" target="_top"><p>長裙</p></a>
                                    <a href="women.html?category=下著&subcategory=短裙" target="_top"><p>短裙</p></a>
                                </div>
                                <div>
                                    <a href="women.html?category=下著&subcategory=長褲" target="_top"><p>長褲</p></a>
                                    <a href="women.html?category=下著&subcategory=短褲" target="_top"><p>短褲</p></a>
                                </div>
                            </ul>
                        </li>
                        <li>
                            <a href="women.html?category=連身" target="_top"></a>
                            <h1>連身</h1>
                        </li>
                    </ul>
                </li>
                <li><a href="styling.html" target="_top">STYLING</a></li>
            </ul>
        </h1>
        <nav>
            <ul>
                <li><a id="search" href="#"><img src="./images/icon/search.svg" alt=""></a></li>
                <li><a id="member" href="./member.html" target="_top"><img src="./images/icon/member.svg" alt=""></a>
                </li>
                <li><a id="cartIcon" href=""><img src="./images/icon/cart.svg" alt=""></a></li>
            </ul>
        </nav>
    </header>
    <div class='cart_num'></div>
    <div class='cart_content'>
        <h2 class="cart_total"></h2>
        <hr />
        <div class='box'>
            <img class="cart_cloth" src="./images/cloth/cl1.webp" alt="" />
            <div class="cart_detail">
                <h2 class="cart_name"></h2>
                <h2 class="cart_qty"></h2>
                <h2 class="cart_price"></h2>
            </div>
            <div class="cart_del" data-index="0"></div>
        </div>
        <div class='box'>
            <img class="cart_cloth" src="./images/cloth/cl1.webp" alt="" />
            <div class="cart_detail">
                <h2 class="cart_name"></h2>
                <h2 class="cart_qty"></h2>
                <h2 class="cart_price"></h2>
            </div>
            <div class="cart_del" data-index="1"></div>
        </div>
        <div class="cart_more">
            <hr />
            ⁝<br>
            還有更多商品
        </div>
        <div class='cart_view'><a href="cart.html" target="_blank">前往購物車</a></div>

    </div>


</body>
<script>
    //購物車商品
    const total = document.querySelector('.cart_total');
    const cart_num = document.querySelector('.cart_num');
    const box = document.querySelectorAll('.box')
    const cart_more = document.querySelector('.cart_more');
    const name1 = document.querySelectorAll('.cart_name')[0];
    const qty1 = document.querySelectorAll('.cart_qty')[0];
    const price1 = document.querySelectorAll('.cart_price')[0];
    const img1 = document.querySelectorAll('.cart_cloth')[0];
    const name2 = document.querySelectorAll('.cart_name')[1];
    const qty2 = document.querySelectorAll('.cart_qty')[1];
    const price2 = document.querySelectorAll('.cart_price')[1];
    const img2 = document.querySelectorAll('.cart_cloth')[1];
    function updateCart() {
        var cart = JSON.parse(window.localStorage.getItem('cart')) || [];
        var totalQty = 0;
        console.log(cart.length);
        if (cart.length === 0) {
            cart_num.style.display = "none";
            total.textContent = "目前沒有商品"
        } else {
            cart.forEach(function (item) {
                totalQty += item.qty;
            });
            cart_num.textContent = totalQty;
            cart_num.style.display = "block";
            total.textContent = `共有商品(${totalQty})`;
            box[0].style.display = "flex";
            const cart1 = cart[0];
            name1.textContent = cart1.name;
            qty1.textContent = `數量:${cart1.qty}`;
            price1.textContent = `NT.${cart1.price}`;
            img1.src = `./images/cloth/cl${cart1.id}.webp`;
            if (cart.length > 1) {
                box[1].style.display = "flex";
                const cart2 = cart[1];
                name2.textContent = cart2.name;
                qty2.textContent = `數量:${cart2.qty}`;
                price2.textContent = `NT.${cart2.price}`;
                img2.src = `./images/cloth/cl${cart2.id}.webp`;
            }
            if (cart.length > 2) {
                cart_more.style.display = "block";
            }
        }
    }
    document.addEventListener("DOMContentLoaded", function () {
        const cartIcon = document.getElementById('cartIcon');
        const cartContent = document.querySelector('.cart_content');

        updateCart()
        cartIcon.addEventListener('click', function (event) {
            event.preventDefault(); // 防止重新加載
            cartContent.style.display = "block";
        });

        document.addEventListener('click', function (event) {
            if (!cartContent.contains(event.target) && !cartIcon.contains(event.target)) {
                cartContent.style.display = "none";
            }
        });
        var deleteButtons = document.querySelectorAll('.cart_del');
        deleteButtons.forEach(function (button) {
            button.addEventListener('click', function () {
                var index = parseInt(button.getAttribute('data-index'));
                var cart = JSON.parse(window.localStorage.getItem('cart'));
                cart.splice(index, 1);
                window.localStorage.setItem('cart', JSON.stringify(cart));
                box.forEach(function (item) {
                item.style.display = "none";
            });
                updateCart();
            });
        });
    });
    window.addEventListener('storage', function (e) {
        if (e.key === 'cart') {
            updateCart();
        }
    });

</script>

<script>
   /*  document.addEventListener('DOMContentLoaded', () => {
        // 監聽來自父窗口的消息
        window.addEventListener('message', (event) => {
            // 檢查消息的來源，在本地環境下event.origin是'null'
            if (event.origin !== 'null' && event.origin !== window.location.origin) {
                return;
            }

            const data = event.data;
            //首頁iframe效果控制
            if (data.type === 'addClass') {
                const element = document.getElementById(data.id);
                if (element) {
                    element.classList.add(data.class);
                }
            } else if (data.type === 'updateStyle') {
                const element = document.getElementById(data.id);
                if (element) {
                    for (const [key, value] of Object.entries(data.style)) {
                        element.style[key] = value;
                    }
                }
            }
        });
    }); */
</script>
<script>
    $(function () {
        /* 隱藏第二層 */
        $('.menu li ul').hide();


        /* 隐藏第二层 */
        $('.menu>li').hover(function () {
            /* 碰到時下彈(>:只有下一層) */
            $('>ul', this).slideDown(500);
        }, function () {
            /* 離開時上彈 */
            $('>ul', this).slideUp(500);
        });
        $('.menu>li>ul>li').hover(function () {
            /* 碰到時下彈(>:只有下一層) */
            $('>ul', this).animate({ width: 'toggle' }, 500);
        }, function () {
            /* 離開時上彈 */
            $('>ul', this).animate({ width: 'toggle' }, 500);
        });

        $('.hamburger').click(function () {
            /* 三條跟X切換(toggleClass增減class) */
            $(this).toggleClass('is-active');
            $('.menu2>li:nth-child(2),.menu2>li:nth-child(3),.menu2>li:nth-child(4),.menu2>li:nth-child(5),.menu2>li:nth-child(6)').animate({ height: 'toggle' }, 500);
        })
    })


</script>

</html>